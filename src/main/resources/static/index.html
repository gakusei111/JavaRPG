<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Java RPG Web Edition</title>
<style>
        /* å…¨ä½“ã®èƒŒæ™¯ã‚’ã€Œå†’é™ºã£ã½ã„ã€è‰²ã« */
        body { 
            background-color: #202028; 
            color: #fff; 
            font-family: 'Courier New', sans-serif; /* ç­‰å¹…ãƒ•ã‚©ãƒ³ãƒˆã§ãƒ¬ãƒˆãƒ­æ„Ÿ */
            text-align: center; 
        }

        /* ãƒ­ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ã€ŒRPGã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ ã€é¢¨ã« */
        #log-window { 
            background: #000; 
            border: 4px double #fff; /* äºŒé‡ç·šã§é«˜ç´šæ„Ÿ */
            border-radius: 8px;      /* è§’ã‚’ä¸¸ã */
            width: 80%; 
            max-width: 600px;        /* åºƒãŒã‚Šã™ããªã„ã‚ˆã†ã« */
            height: 300px; 
            margin: 20px auto; 
            overflow-y: scroll; 
            padding: 20px; 
            text-align: left;
            font-size: 16px;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.2); /* ã»ã‚“ã®ã‚Šå…‰ã‚‰ã›ã‚‹ */
        }

        /* 1è¡Œã”ã¨ã®æ¼”å‡º */
        .log-entry { 
            margin-bottom: 8px; 
            border-bottom: 1px dashed #444; 
            padding-bottom: 4px; 
            animation: fadeIn 0.5s ease-in; /* ãµã‚ã£ã¨è¡¨ç¤ºã•ã›ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        }

        /* ãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        button { 
            background-color: #8b0000; /* æš—ã‚ã®èµ¤ */
            color: white; 
            border: 2px solid #ff4500; 
            padding: 10px 30px; 
            font-size: 18px; 
            font-weight: bold;
            cursor: pointer; 
            transition: 0.3s;
        }
        button:hover {
            background-color: #ff4500; /* ãƒã‚¦ã‚¹ã‚’ä¹—ã›ã‚‹ã¨æ˜ã‚‹ããªã‚‹ */
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®šç¾© */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <h1>âš”ï¸ Java RPG Battle âš”ï¸</h1>
    
    <div>
        <input type="text" id="playerName" placeholder="å‹‡è€…ã®åå‰ã‚’å…¥åŠ›" value="å‹‡è€…">
        <button onclick="startBattle()">å†’é™ºã«å‡ºã‚‹ï¼</button>
    </div>

    <div id="log-window">
        <div class="log-entry">å†’é™ºã®æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚</div>
    </div>

    <script>
        async function startBattle() {
            const name = document.getElementById('playerName').value;
            const logWindow = document.getElementById('log-window');
            logWindow.innerHTML = "æˆ¦é—˜é–‹å§‹ä¸­...";

            try {
                // Javaã®APIã‚’å©ãï¼ˆæ³¨æ–‡ã‚’å‡ºã™ï¼‰
                const response = await fetch(`/api/battle?name=${name}`);
                const logs = await response.json(); // JSONã¨ã—ã¦å—ã‘å–ã‚‹

                // ç”»é¢ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ãƒ­ã‚°ã‚’è¡¨ç¤º
                logWindow.innerHTML = "";
                logs.forEach(log => {
                    const div = document.createElement('div');
                    div.className = 'log-entry';
                    div.innerText = log; // æ–‡å­—åˆ—ãƒªã‚¹ãƒˆã®å ´åˆ
                    logWindow.appendChild(div);
                });
            } catch (error) {
                logWindow.innerHTML = "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " + error;
            }
        }
        async function loadHistory() {
    const list = document.getElementById('history-list');
    list.innerHTML = "èª­ã¿è¾¼ã¿ä¸­...";

    try {
        // Java ã§ä½œã£ãŸ @GetMapping("/history") ã‚’å©ã
        const response = await fetch('/api/history');
        const history = await response.json();

        list.innerHTML = ""; // è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢
        
        // æœ€æ–°ã® 5 ä»¶ã‚’è¡¨ç¤ºï¼ˆæ–°ã—ã„é †ã«ã—ãŸã„å ´åˆã¯ reverse() ã‚’ä½¿ã†ï¼‰
        history.reverse().slice(0, 5).forEach(item => {
            const li = document.createElement('li');
            li.className = 'log-entry'; // æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æµç”¨
            
            // æ—¥ä»˜ã‚’èª­ã¿ã‚„ã™ãæ•´å½¢
            const date = new Date(item.createdAt).toLocaleString();
            
            li.innerHTML = `
                <span style="color: #888;">[${date}]</span><br>
                <strong>${item.enemyName}</strong> ã¨ã®æˆ¦é—˜ 
                â†’ <span style="color: ${item.winner === 'å‹‡è€…' ? '#00ff00' : '#ff4500'}">å‹è€…: ${item.winner}</span>
            `;
            list.appendChild(li);
        });

        if (history.length === 0) {
            list.innerHTML = "ã¾ã æˆ¦ç¸¾ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚";
        }
    } catch (error) {
        list.innerHTML = "å±¥æ­´ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: " + error;
    }
}

// ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸæ™‚ã«ã‚‚è‡ªå‹•ã§èª­ã¿è¾¼ã‚€
window.onload = loadHistory;
    </script>
    <hr style="margin-top: 40px; border: 1px double #444;">
<h2>ğŸ“œ éå»ã®æˆ¦ç¸¾ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ï¼‰</h2>
<button onclick="loadHistory()" style="background-color: #2e8b57; border-color: #3cb371;">å±¥æ­´ã‚’æ›´æ–°</button>

<ul id="history-list" style="text-align: left; max-width: 600px; margin: 20px auto; list-style: none; padding: 0;">
    </ul>
</body>
</html>